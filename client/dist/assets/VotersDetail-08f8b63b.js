import{A as p,r as d,u as D,a as _,c as V,d as C,i as F,k as $,j as e,L as O,$ as g,_ as x,T as A}from"./index-2825ce6d.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[t]="9af539b2-be16-4182-bd48-7d0118cc55e5",r._sentryDebugIdIdentifier="sentry-dbid-9af539b2-be16-4182-bd48-7d0118cc55e5")}catch{}})();const L=async(r,t)=>{const a=localStorage.getItem("authToken")??"";try{r({type:"FETCH_VOTERS_DETAIL_REQUEST"});const o=await fetch(`${p}/voter/${t}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}});debugger;const i=await o.json();debugger;r({type:"FETCH_VOTERS_DETAIL_SUCCESS",payload:i})}catch(o){console.log("Error fetching voters for election:",o),r({type:"FETCH_VOTERS_DETAIL_FAILURE",payload:"Unable to load voters for election"})}},P=async(r,t,a)=>{try{debugger;const o=localStorage.getItem("authToken")??"",i=await fetch(`${p}/voter/${t}/addVoter`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(a)});debugger;const l=await i.json();if(!i.ok)throw new Error("Failed to create voter for election "+t);return l.error?{ok:!1,error:l.error}:(r({type:"ADD_VOTER_SUCCESS",payload:l}),{ok:!0})}catch(o){return console.error("Operation failed:",o),{ok:!1,error:o}}},B=async(r,t)=>{try{const a=localStorage.getItem("authToken")??"";debugger;const o=await fetch(`${p}/voter/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}});if(!o.ok)throw new Error("Failed to delete voter with id "+t);const i=await o.json();debugger;return i.error?{ok:!1,error:i.error}:i.success?(r({type:"DELETE_VOTER_SUCCESS",payload:t}),{ok:!0}):{ok:!1}}catch(a){return console.error("Operation failed:",a),{ok:!1,error:a}}},z=()=>{var j;let[r,t]=d.useState(!1);const[a,o]=d.useState(null),i=()=>t(!0),l=()=>t(!1),{register:y,handleSubmit:T,formState:{errors:m}}=D(),f=_();let{electionID:c}=V();const{t:n}=C();debugger;const E=F(),{voters:v,isLoading:N,isError:H,errorMessage:R}=E,h=$();d.useEffect(()=>{c&&L(h,c)},[c,h]);const u=(j=f==null?void 0:f.elections.filter(s=>`${s==null?void 0:s.id}`===c))==null?void 0:j[0];if(N)return e.jsx(e.Fragment,{children:n("loading")});if(!u)return e.jsx("p",{className:"font-semibold text-center text-red-500",children:"There is not such a Election"});const k=async s=>{console.log(s);const b=await B(h,s);console.log(b)},S=async s=>{const{voterId:b,password:I}=s,w=await P(h,u==null?void 0:u.id,{voterId:b,password:I});debugger;w.ok?t(!1):o(w.error)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mx-auto mb-3",children:e.jsx(O,{to:`/account/election/${c}`,className:"rounded text-white bg-black text-sm inline px-2 py-2",children:n("gotoBallotPage")})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h2",{className:"text-2xl mt-3 text-green-700 font-medium tracking-tight  dark:text-zinc-50",children:[n("manageVoter")," : ",u.title]}),e.jsx("button",{id:"newVoterBtn",onClick:i,className:"rounded-md bg-blue-600 px-4 py-2 m-2 text-sm font-medium text-white hover:bg-opacity-95 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75",children:n("newVoterButtonText")}),e.jsx(g,{appear:!0,show:r,as:d.Fragment,children:e.jsxs(x,{as:"div",className:"relative z-10",onClose:l,children:[e.jsx(g.Child,{as:d.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(g.Child,{as:d.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(x.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsx(x.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:n("NewVoterModalHeader")}),e.jsx("div",{className:"mt-2",children:e.jsxs("form",{onSubmit:T(S),children:[a&&e.jsx("span",{className:"text-red-500",children:a}),e.jsx("input",{type:"text",id:"voterID",placeholder:n("newVoterIdPlaceHolder"),autoFocus:!0,...y("voterId",{required:!0}),className:`w-full border rounded-md py-2 px-3 my-4 text-gray-700 leading-tight focus:outline-none focus:border-blue-500 focus:shadow-outline-blue ${m.voterId?"border-red-500":""}`}),m.voterId&&e.jsx("span",{className:"text-red-500",children:"This field is required"}),e.jsx("input",{type:"password",id:"pwd",placeholder:n("voterPasswordPlaceHolder"),autoFocus:!0,...y("password",{required:!0}),className:`w-full border rounded-md py-2 px-3 my-4 text-gray-700 leading-tight focus:outline-none focus:border-blue-500 focus:shadow-outline-blue ${m.password?"border-red-500":""}`}),m.password&&e.jsx("span",{className:"text-red-500",children:"This field is required"}),e.jsx("button",{type:"submit",id:"create-member-btn",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 mr-2 text-sm font-medium text-white hover:bg-blue-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:n("submitButtonText")}),e.jsx("button",{type:"submit",onClick:l,className:"inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:n("cancelButtonText")})]})})]})})})})]})})]}),v.length?e.jsxs("div",{className:"mt-5",children:[e.jsx("h3",{className:"text-xl font-bold my-3",children:n("listHeaderVoter")}),e.jsx("div",{className:"grid gap-4 grid-cols-4 mt-5",children:v.map(s=>e.jsx("div",{className:"block p-6 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsxs("h5",{className:"mb-2 text-lg font-medium tracking-tight text-slate-700 dark:text-white",children:[e.jsxs("span",{className:"font-bold",children:[n("VoterId")," : "]}),s.voterId]})}),e.jsx("button",{onClick:()=>{k(s.id)},children:e.jsx(A,{className:"h-8 w-8 text-red-600 hover:bg-red-500 hover:text-white border-red-600 border-2 hover:border-red-700 p-1 rounded-md transition duration-1200","aria-hidden":"true"})})]})},`${s.id}-${s.voterId}`))}),e.jsx("div",{})]}):e.jsx("p",{className:"text-red-500",children:n("noVoteradded")})]})};export{z as default};
//# sourceMappingURL=VotersDetail-08f8b63b.js.map

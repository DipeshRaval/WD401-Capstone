import{A as p,r as d,u as _,h as V,i as C,a as F,b as $,k as O,l as A,m as L,j as e,L as P,$ as b,_ as x,T as B}from"./index-44600ca5.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[t]="a8d6c2f1-cbc9-418d-960e-4a76e44d0ff7",o._sentryDebugIdIdentifier="sentry-dbid-a8d6c2f1-cbc9-418d-960e-4a76e44d0ff7")}catch{}})();const H=async(o,t)=>{const n=localStorage.getItem("authToken")??"";try{o({type:"FETCH_VOTERS_DETAIL_REQUEST"});const s=await fetch(`${p}/voter/${t}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});debugger;const i=await s.json();debugger;o({type:"FETCH_VOTERS_DETAIL_SUCCESS",payload:i})}catch(s){console.log("Error fetching voters for election:",s),o({type:"FETCH_VOTERS_DETAIL_FAILURE",payload:"Unable to load voters for election"})}},R=async(o,t,n)=>{try{debugger;const s=localStorage.getItem("authToken")??"",i=await fetch(`${p}/voter/${t}/addVoter`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(n)});debugger;const l=await i.json();if(!i.ok)throw new Error("Failed to create voter for election "+t);return l.error?{ok:!1,error:l.error}:(o({type:"ADD_VOTER_SUCCESS",payload:l}),{ok:!0})}catch(s){return console.error("Operation failed:",s),{ok:!1,error:s}}},U=async(o,t)=>{try{const n=localStorage.getItem("authToken")??"";debugger;const s=await fetch(`${p}/voter/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});if(!s.ok)throw new Error("Failed to delete voter with id "+t);const i=await s.json();debugger;return i.error?{ok:!1,error:i.error}:i.success?(o({type:"DELETE_VOTER_SUCCESS",payload:t}),{ok:!0}):{ok:!1}}catch(n){return console.error("Operation failed:",n),{ok:!1,error:n}}},G=()=>{var j;let[o,t]=d.useState(!1);const[n,s]=d.useState(null),i=()=>t(!0),l=()=>t(!1),{register:y,handleSubmit:E,formState:{errors:f}}=_(),h=V(),N=C();let{electionID:c}=F();const{t:r}=$();debugger;const T=O(),{voters:v,isLoading:k,isError:z,errorMessage:q}=T,m=A();d.useEffect(()=>{c&&(L(N),H(m,c))},[c,m]);const u=(j=h==null?void 0:h.elections.filter(a=>`${a==null?void 0:a.id}`===c))==null?void 0:j[0];if(k)return e.jsx(e.Fragment,{children:r("loading")});if(!u)return e.jsx("p",{className:"font-semibold text-center text-red-500",children:r("noSelectedElections")});const S=async a=>{console.log(a);const g=await U(m,a);console.log(g)},I=async a=>{const{voterId:g,password:D}=a,w=await R(m,u==null?void 0:u.id,{voterId:g,password:D});debugger;w.ok?t(!1):s(w.error)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mx-auto mb-3",children:e.jsx(P,{to:`/account/election/${c}`,className:"rounded text-white bg-black text-sm inline px-2 py-2",children:r("gotoBallotPage")})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h2",{className:"text-2xl mt-3 text-green-700 font-medium tracking-tight  dark:text-zinc-50",children:[r("manageVoter")," : ",u.title]}),e.jsx("button",{id:"newVoterBtn",onClick:i,className:"rounded-md bg-blue-600 px-4 py-2 m-2 text-sm font-medium text-white hover:bg-opacity-95 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75",children:r("newVoterButtonText")}),e.jsx(b,{appear:!0,show:o,as:d.Fragment,children:e.jsxs(x,{as:"div",className:"relative z-10",onClose:l,children:[e.jsx(b.Child,{as:d.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(b.Child,{as:d.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(x.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsx(x.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:r("NewVoterModalHeader")}),e.jsx("div",{className:"mt-2",children:e.jsxs("form",{onSubmit:E(I),children:[n&&e.jsx("span",{className:"text-red-500",children:n}),e.jsx("input",{type:"text",id:"voterID",placeholder:r("newVoterIdPlaceHolder"),autoFocus:!0,...y("voterId",{required:!0}),className:`w-full border rounded-md py-2 px-3 my-4 text-gray-700 leading-tight focus:outline-none focus:border-blue-500 focus:shadow-outline-blue ${f.voterId?"border-red-500":""}`}),f.voterId&&e.jsx("span",{className:"text-red-500",children:r("requiredNote")}),e.jsx("input",{type:"password",id:"pwd",placeholder:r("voterPasswordPlaceHolder"),autoFocus:!0,...y("password",{required:!0}),className:`w-full border rounded-md py-2 px-3 my-4 text-gray-700 leading-tight focus:outline-none focus:border-blue-500 focus:shadow-outline-blue ${f.password?"border-red-500":""}`}),f.password&&e.jsx("span",{className:"text-red-500",children:r("requiredNote")}),e.jsx("button",{type:"submit",id:"create-member-btn",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 mr-2 text-sm font-medium text-white hover:bg-blue-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:r("submitButtonText")}),e.jsx("button",{type:"submit",onClick:l,className:"inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:r("cancelButtonText")})]})})]})})})})]})})]}),v.length?e.jsxs("div",{className:"mt-5",children:[e.jsx("h3",{className:"text-xl font-bold my-3",children:r("listHeaderVoter")}),e.jsx("div",{className:"grid gap-4 grid-cols-4 mt-5",children:v.map(a=>e.jsx("div",{className:"block p-6 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsxs("h5",{className:"mb-2 text-lg font-medium tracking-tight text-slate-700 dark:text-white",children:[e.jsxs("span",{className:"font-bold",children:[r("VoterId")," : "]}),a.voterId]})}),e.jsx("button",{onClick:()=>{S(a.id)},children:e.jsx(B,{className:"h-8 w-8 text-red-600 hover:bg-red-500 hover:text-white border-red-600 border-2 hover:border-red-700 p-1 rounded-md transition duration-1200","aria-hidden":"true"})})]})},`${a.id}-${a.voterId}`))}),e.jsx("div",{})]}):e.jsx("p",{className:"text-red-500",children:r("noVoteradded")})]})};export{G as default};
//# sourceMappingURL=VotersDetail-ad815902.js.map
